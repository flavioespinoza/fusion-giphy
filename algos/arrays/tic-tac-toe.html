<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tic Tac Toe</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <!-- <link
      href="https://fonts.googleapis.com/css2?family=Nerko+One&display=swap"
      rel="stylesheet"
    /> -->
    <style>
      #board {
        width: 280px;
        min-height: 450px;
        border-radius: 10%;
        padding: 0 20px 20px 20px;
        text-align: center;
        background-color: grey;
        color: white;
      }

      h1 {
        padding-top: 12px;
      }

      h2 {
        margin: 8px;
      }

      table {
        margin: auto;
        border-spacing: 8px;
      }

      button {
        font-weight: bold;
        border-radius: 8px;
        cursor: pointer;
        background-color: #6e072d;
        border-color: #6e6e6e;
        color: white;
      }

      .game-square {
        font-size: 50px;
        width: 70px;
        height: 70px;
        vertical-align: top;
      }

      .game-square:disabled {
        cursor: default;
      }

      #restart-button {
        display: none;
        font-size: 24px;
        padding: 12px;
        margin: 12px auto;
      }
    </style>
  </head>

  <body>
    <div id="board">
      <h1>Tic Tac Toe</h1>
      <h2 id="game-heading" aria-live="polite">Player 1's Turn</h2>
      <table role="grid">
        <tbody>
          <tr>
            <td><button class="game-square"></button></td>
            <td><button class="game-square"></button></td>
            <td><button class="game-square"></button></td>
          </tr>
          <tr>
            <td><button class="game-square"></button></td>
            <td><button class="game-square"></button></td>
            <td><button class="game-square"></button></td>
          </tr>
          <tr>
            <td><button class="game-square"></button></td>
            <td><button class="game-square"></button></td>
            <td><button class="game-square"></button></td>
          </tr>
        </tbody>
      </table>
      <button id="restart-button">Restart Game</button>
    </div>

    <script>
      const boxes = document.querySelectorAll('.game-square');
      const header = document.getElementById('game-heading');
      const resetBtn = document.getElementById('restart-button');

      const tick_x = 'X';
      const tick_o = 'O';

      let spaces = [];
      let currentPlayer = tick_x;

      const playerWon = () => {
        const firstSquare = spaces[0];
        const middleSquare = spaces[4];
        const lastSquare = spaces[8];
        if (firstSquare === currentPlayer) {
          if (
            (spaces[1] === currentPlayer && spaces[2] === currentPlayer) ||
            (spaces[3] === currentPlayer && spaces[6] === currentPlayer) ||
            (spaces[4] === currentPlayer && spaces[8] === currentPlayer)
          ) {
            return true;
          }
        }
        if (middleSquare === currentPlayer) {
          if (
            (spaces[1] === currentPlayer && spaces[7] === currentPlayer) ||
            (spaces[3] === currentPlayer && spaces[5] === currentPlayer) ||
            (spaces[2] === currentPlayer && spaces[6] === currentPlayer)
          ) {
            return true;
          }
        }
        if (lastSquare === currentPlayer) {
          if (
            (spaces[2] === currentPlayer && spaces[5] === currentPlayer) ||
            (spaces[6] === currentPlayer && spaces[7] === currentPlayer)
          ) {
            return true;
          }
        }
        return false;
      };

      const playerDraw = () => {
        let moves = 0;
        for (let i = 0; i < spaces.length; i++) {
          if (spaces[i]) {
            moves++;
          }
        }
        if (moves === 9) {
          return true;
        }
        return false;
      };

      const boxClicked = (e) => {
        const id = e.target.id;
        if (!spaces[id]) {
          spaces[id] = currentPlayer;
          e.target.textContent = currentPlayer;
          e.target.disabled = true;
          // if a player has won or if there is a tie game
          if (playerWon()) {
            if (currentPlayer === 'X') {
              header.textContent = 'Player 1 Won!';
            } else {
              header.textContent = 'Player 2 Won!';
            }
            return true;
          }
          if (playerDraw()) {
            header.textContent = 'Tie Game!';
            return true;
          }
        }
        return false;
      };

      const handleClick = (e) => {
        let gameOver = boxClicked(e);
        if (gameOver) {
          resetBtn.style.display = 'block';
          for (const box of boxes) {
            box.disabled = true;
          }
        } else {
          if (currentPlayer === 'X') {
            currentPlayer = tick_o;
            header.textContent = `Player 2's Turn`;
          } else {
            currentPlayer = tick_x;
            header.textContent = `Player 1's Turn`;
          }
        }
      };

      const handleReset = () => {
        spaces = [];
        for (const box of boxes) {
          box.textContent = '';
          box.disabled = false;
        }
        resetBtn.style.display = 'none';
        header.textContent = `Player 1's Turn`;
        currentPlayer = tick_x;
      };

      const init = () => {
        let id = 0;
        for (const box of boxes) {
          box.id = id;
          box.textContent = '';
          box.addEventListener('click', handleClick);
          id++;
        }
        currentPlayer = tick_x;
        resetBtn.addEventListener('click', handleReset);
      };

      init();
    </script>
  </body>
</html>
